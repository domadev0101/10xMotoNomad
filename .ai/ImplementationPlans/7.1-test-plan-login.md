# Test Plan - Login Flow

**Feature:** Login (Phase 4 - Authentication)  
**Status:** 🔄 Finished - Login Working!

---

## Pre-requisites

- [x] `appsettings.json` configured with real Supabase URL and Anon Key
- [x] `MockAuth.Enabled: false`
- [x] User exists in Supabase Authentication
- [x] User's email is confirmed (if email confirmation enabled)

---

## Test Case 1: Form Validation - Empty Fields

**Steps:**
1. Launch the application: `dotnet watch` or F5
2. Navigate to `/login`
3. Click the "Login" button **without entering any data**

**Expected Result:**
- The "Login" button is **disabled** (because `_formValid = false`)
- Email and Password fields show red borders
- Error messages appear below the fields:
  - Email: "Email is required"
  - Password: "Password is required"

**Status:** ✅ Passed

---

## Test Case 2: Form Validation - Invalid Email Format

**Steps:**
1. In the Email field, enter: `invalid-email` (without @)
2. In the Password field, enter: `test1234`
3. Click the "Login" button

**Expected Result:**
- The "Login" button is **disabled**
- The Email field shows a red border
- Below the Email field, message: "Invalid email format"

**Status:** ✅ Passed

---

## Test Case 3: Form Validation - Password Too Short

**Steps:**
1. In the Email field, enter: `test@example.com`
2. In the Password field, enter: `short` (less than 8 characters)
3. Click the "Login" button

**Expected Result:**
- The "Login" button is **disabled**
- The Password field shows a red border
- Below the Password field, message: "Password must be at least 8 characters"

**Status:** ✅ Passed

---

## Test Case 4: Login - Invalid Credentials (AuthException)

**Steps:**
1. In the Email field, enter: `test@example.com`
2. In the Password field, enter: `wrongpassword123`
3. Click the "Login" button

**Expected Result:**
- The "Login" button shows spinner + "Logging in..."
- After ~1-2 seconds, a **MudAlert** (red) appears with the message:
  - "Invalid email or password."
- **MudSnackbar** (Error) with the same message
- The form remains filled (user can correct the data)
- The "Login" button is active again

**Status:** ✅ Passed

---

## Test Case 5: Login - Correct Credentials (SUCCESS) ?

**Steps:**
1. In the Email field, enter: `{YOUR_REAL_EMAIL_FROM_SUPABASE}`
2. In the Password field, enter: `{YOUR_REAL_PASSWORD}`
3. Click the "Login" button

**Expected Result:**
- The "Login" button shows spinner + "Logging in..."
- After ~1-2 seconds, a **MudSnackbar** (Success) appears:
  - "Login successful!"
- User is **automatically redirected** to `/trips`
- In the top right corner (NavMenu), **LoginDisplay** appears with avatar and email
- NavMenu shows links for logged-in users:
  - "My Trips"
  - "Logout" button

**Status:** ✅ Passed

---

## Test Case 6: Guard Clause - Logged-in User Tries to Access /login

**Steps:**
1. Log in (Test Case 5)
2. Manually type in the address bar: `/login`
3. Press Enter

**Expected Result:**
- User is **immediately redirected** to `/trips`
- Does not see the login form

**Status:** ✅ Passed

---

## Test Case 7: Autofocus on Email Field

**Steps:**
1. Open `/login`
2. Check which field has focus

**Expected Result:**
- The Email field has automatic focus (blinking cursor)
- You can start typing the email immediately without clicking

**Status:** ✅ Passed

---

## Test Case 8: Link to Register

**Steps:**
1. On the `/login` page
2. Click the link "Don't have an account? Register"

**Expected Result:**
- Redirect to `/register`

**Status:** ✅ Passed

---

## Test Case 9: Keyboard Navigation (Enter)

**Steps:**
1. Open `/login`
2. Enter correct email and password
3. Press **Enter** (instead of clicking the button)

**Expected Result:**
- The form is submitted (same behavior as clicking the button)
- Login works correctly

**Status:** ✅ Passed

---

## Test Case 10: Responsiveness (Mobile)

**Steps:**
1. Open DevTools (F12)
2. Toggle Device Toolbar (Ctrl+Shift+M)
3. Select Mobile device (e.g., iPhone 12)
4. Check `/login`

**Expected Result:**
- The form is responsive
- MudCard does not go beyond the screen
- Buttons are clickable
- Fields are easy to fill (not too small)

**Status:** ✅ Passed

---

## Test Case 11: Browser Console - No Errors

**Steps:**
1. Open DevTools (F12) → Console
2. Go through the entire login flow
3. Check if there are errors in the console

**Expected Result:**
- No JS errors (red messages)
- Warnings (yellow) may be present - that's OK
- Console log shows:
  ```
  Initializing Supabase connection...
  Application startup completed successfully
  User logged in successfully: {email}
  ```

**Status:** ✅ Passed

---

## Test Case 12: Network Tab - Supabase API Calls

**Steps:**
1. Open DevTools (F12) → Network
2. Log in
3. Check network calls

**Expected Result:**
- Request to `https://{PROJECT_ID}.supabase.co/auth/v1/token?grant_type=password`
- Status: **200 OK**
- Response contains `access_token` and `refresh_token`

**Status:** ✅ Passed

---

## Bugs Found

| # | Description | Severity | Status |
|---|-------------|----------|--------|
| - | None found yet | - | - |

---

## Notes

- Login successful with real Supabase user!



---
  
**Tester:** User  
**Overall Status:** ✅ Core Functionality Working - Additional tests pending



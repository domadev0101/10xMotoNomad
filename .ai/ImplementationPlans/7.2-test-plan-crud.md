# Test Plan - CRUD Operations

**Data:** 2025-01-XX  
**Feature:** CRUD Operations (Trips, Companions, Profiles)  
**Status:** ⏳ Not Started

---

## Pre-requisites

- [x] User logged in with valid session
- [x] `appsettings.json` configured with real Supabase URL and Anon Key
- [x] `MockAuth.Enabled: false`
- [x] Database tables created (trips, companions, profiles)
- [x] RLS policies enabled and tested
- [x] All services registered in Program.cs

---

## SECTION A: TRIPS CRUD

### Test Case A1: Create Trip - Form validation - empty fields

**Steps:**
1. Log in to the application
2. Navigate to `/trip/create`
3. Click the "Save" button **without entering any data**

**Expected result:**
- ✅ "Save" button is **disabled** (because `_formValid = false`)
- ✅ Fields show red borders:
  - Name: "Trip name is required"
  - StartDate: "Start date is required"
  - EndDate: "End date is required"
  - TransportType: "Transport type is required"

**Status:** ✅ Passed

---

### Test Case A2: Create Trip - Date validation (EndDate <= StartDate)

**Steps:**
1. Navigate to `/trip/create`
2. Fill in fields:
 - Name: "Test Trip"
   - StartDate: 2025-02-15
   - EndDate: 2025-02-10 (earlier than StartDate)
   - Transport: Motorcycle

3. Click "Save"

**Expected result:**
- ✅ "Save" button is **disabled**
- ✅ EndDate field shows red border
- ✅ Error message: "End date must be later than start date"

**Status:** ✅ Passed

---

### Test Case A3: Create Trip - Name too long (> 200 characters)

**Steps:**
1. Navigate to `/trip/create`
2. In the Name field, enter text longer than 200 characters
3. Fill in the remaining fields correctly
4. Click "Save"

**Expected result:**
- ✅ "Save" button is **disabled**
- ✅ Name field shows red border
- ✅ Error message: "Name cannot exceed 200 characters"

**Status:** ✅ Passed

---

### Test Case A4: Create Trip - Description too long (> 2000 characters)

**Steps:**
1. Navigate to `/trip/create`
2. Fill in all required fields correctly
3. In the Description field, enter text longer than 2000 characters
4. Click "Save"

**Expected result:**
- ✅ "Save" button is **disabled**
- ✅ Description field shows red border
- ✅ Error message: "Description cannot exceed 2000 characters"

**Status:** ✅ Passed

---

### Test Case A5: Create Trip - Success (all fields correct)

**Steps:**
1. Navigate to `/trip/create`
2. Fill in fields:
   - Name: "Test Motorcycle Trip"
   - StartDate: 2025-03-01
   - EndDate: 2025-03-10
   - Description: "Test description for trip"
   - Transport: Motorcycle

3. Click "Save"

**Expected result:**
- ✅ "Save" button shows spinner + "Saving..."
- ✅ After ~1-2 seconds, **MudSnackbar** (Success) appears:
  - "Trip 'Test Motorcycle Trip' has been created!"
- ✅ User is **automatically redirected** to `/trips`
- ✅ New trip appears in the list with:
  - Name: "Test Motorcycle Trip"
  - Dates: 01.03.2025 - 10.03.2025
  - Duration: 9 days
  - Transport: Motorcycle icon
  - Companion count: 0

**Status:** ✅ Passed

---

### Test Case A6: Create Trip - Cancel

**Steps:**
1. Navigate to `/trip/create`
2. Fill in some fields
3. Click "Cancel"

**Expected result:**
- ✅ User is **immediately redirected** to `/trips`
- ✅ Form data is **lost** (no auto-save)
- ✅ No confirmation dialog

**Status:** ✅ Passed

---

### Test Case A7: Read Trip - Trips list (GetAllTrips)

**Pre-requisite:** At least 1 trip created (Test Case A5)

**Steps:**
1. Navigate to `/trips`
2. Check the trips list

**Expected result:**
- ✅ List displays all trips for the user
- ✅ Each card contains:
  - Trip name
  - Dates (StartDate - EndDate)
  - Duration (calculated days)
  - Transport icon (appropriate icon for type)
  - Companion count (number of companions)
- ✅ Trips sorted by StartDate (descending - newest first)
- ✅ Clicking a card → navigates to `/trip/{id}`

**Status:** ✅ Passed

---

### Test Case A8: Read Trip - Trip details (GetTripById)

**Pre-requisite:** At least 1 trip created

**Steps:**
1. Navigate to `/trips`
2. Click on a trip card
3. Check the content of page `/trip/{id}`

**Expected result:**
- ✅ Parallel loading of Trip + Companions (global spinner)
- ✅ After loading, visible:
  - Breadcrumbs: "My trips > [Trip name]"
  - "Details" tab (active by default)
  - "Companions (0)" tab
- ✅ Edit form filled with data:
  - Name
  - StartDate
  - EndDate
  - Description
  - TransportType
- ✅ Buttons:
  - "Save changes" (Primary, active)
- Trash icon "Delete trip" (Error)

**Status:** ✅ Passed

---

### Test Case A9: Update Trip - Edit name

**Pre-requisite:** Trip created and `/trip/{id}` open

**Steps:**
1. In the "Details" tab, change the Name field to "Updated Trip Name"
2. Click "Save changes"

**Expected result:**
- ✅ "Save changes" button shows spinner
- ✅ After ~1-2 seconds, **MudSnackbar** (Success) appears:
  - "Changes have been saved!"
- ✅ Form remains open (no redirect)
- ✅ Breadcrumb updates name: "My trips > Updated Trip Name"
- ✅ Navigate to `/trips` → card displays new name

**Status:** ✅ Passed

---

### Test Case A10: Update Trip - Date validation (EndDate <= StartDate)

**Pre-requisite:** Trip created and `/trip/{id}` open

**Steps:**
1. Change EndDate to a date earlier than StartDate
2. Click "Save changes"

**Expected result:**
- ✅ "Save changes" button is **disabled**
- ✅ EndDate field shows red border
- ✅ Error message: "End date must be after start date"

**Status:** ✅ Passed

---

### Test Case A11: Delete Trip - Confirmation dialog

**Pre-requisite:** Trip created and `/trip/{id}` open

**Steps:**
1. In the "Details" tab, click the trash icon "Delete trip"
2. Check the confirmation dialog

**Expected result:**
- ✅ Display of **DeleteTripConfirmationDialog**
- ✅ Title: "Confirm deletion"
- ✅ Content: "Are you sure you want to delete the trip **[Trip name]**?"
- ✅ Warning alert (yellow): "This action is irreversible. All data related to the trip, including the companions list, will be permanently deleted."
- ✅ Buttons:
  - "Cancel" (default, on the left)
  - "Delete" (red, on the right)

**Status:** ✅ Passed

---

### Test Case A12: Delete Trip - Cancel deletion

**Pre-requisite:** Confirmation dialog open (Test Case A11)

**Steps:**
1. Click "Cancel" in the dialog (or press Escape)

**Expected result:**
- ✅ Dialog closes
- ✅ No further actions
- ✅ Trip is **not deleted**
- ✅ Remains on the `/trip/{id}` page

**Status:** ✅ Passed 

---

### Test Case A13: Delete Trip - Confirm deletion (SUCCESS)

**Pre-requisite:** Confirmation dialog open (Test Case A11)

**Steps:**
1. Click "Delete" in the dialog

**Expected result:**
- ✅ Dialog closes
- ✅ After ~1-2 seconds, **MudSnackbar** (Success) appears:
  - "Trip '[Trip name]' has been deleted."
- ✅ User is **automatically redirected** to `/trips`
- ✅ Trip **does not appear** in the list (deleted from database)

**Status:** ✅ Passed

---

### Test Case A14: RLS Security - Attempt to access another user's trip

**Pre-requisite:** Two user accounts (User A, User B), User A has trips

**Steps:**
1. Log in as User A
2. Open a trip → copy the ID from the URL (`/trip/{id}`)
3. **Verify you're logged in:** Check NavMenu shows "Hello, [User A]!" + Logout button
4. Log out
5. Log in as User B
6. **Verify you're logged in:** Check NavMenu shows "Hello, [User B]!" + Logout button
7. **Open /health and verify:**
   - "Client Initialization" - SUCCESS ✅
   - "Database Connectivity" - SUCCESS ✅
   - "Auth Status" - User is authenticated ✅
8. Paste the URL with User A's trip ID in address bar
9. Press Enter

**Expected result:**
- ✅ **IF User B's session is valid:**
  - After attempting to load the trip, **MudSnackbar** (Warning) appears:
    - "Trip not found."
  - User is **automatically redirected** to `/trips`
  - No ability to read other users' trips (RLS blocks - returns null)
- ❌ **IF User B's session expired:**
  - Login page appears (this is correct behavior for expired session)
  - **This is NOT an RLS test failure** - it's authentication failure

**Troubleshooting:**
If you see login page instead of "Trip not found":
1. Check if User B is actually logged in (NavMenu should show logout button)
2. Open F12 → Application → Local Storage → Check if `supabase.auth.token` exists
3. Open F12 → Network → Check if Authorization header is present in requests
4. If token is missing or expired → log in again and retry test immediately
5. Supabase session expires after 1 hour by default - test must be done within this window

**Status:** ✅ Passed 

---

## SECTION B: COMPANIONS CRUD

### Test Case B1: Read Companions - Empty list (EmptyState)

**Pre-requisite:** Trip created without companions

**Steps:**
1. Open `/trip/{id}`
2. Switch to the "Companions (0)" tab

**Expected result:**
- ✅ Display of **EmptyState**:
  - Title: "No companions"
  - Message: "Add people who will accompany you on the trip"
  - Icon: Icons.Material.Filled.People
  - ButtonText: "Add first companion"
- ✅ Clicking the button → displays CompanionForm

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B2: Create Companion - Validation - empty fields

**Pre-requisite:** "Companions" tab open, form visible

**Steps:**
1. Click "Add companion" (if form hidden)
2. Click "Save" **without entering any data**

**Expected result:**
- ✅ "Save" button is **disabled** (because `_formValid = false`)
- ✅ Fields show red borders:
  - FirstName: "First name is required"
  - LastName: "Last name is required"
- ✅ Contact field **does not show error** (optional)

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B3: Create Companion - First name too long (> 100 characters)

**Steps:**
1. In the companion form, enter:
   - FirstName: text longer than 100 characters
   - LastName: "Test"

2. Click "Save"

**Expected result:**
- ✅ "Save" button is **disabled**
- ✅ FirstName field shows red border
- ✅ Error message: "First name cannot exceed 100 characters"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B4: Create Companion - Last name too long (> 100 characters)

**Steps:**
1. In the companion form, enter:
   - FirstName: "Test"
   - LastName: text longer than 100 characters

2. Click "Save"

**Expected result:**
- ✅ "Save" button is **disabled**
- ✅ LastName field shows red border
- ✅ Error message: "Last name cannot exceed 100 characters"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B5: Create Companion - Contact too long (> 255 characters)

**Steps:**
1. In the companion form, enter:
   - FirstName: "Test"
   - LastName: "User"
   - Contact: text longer than 255 characters

2. Click "Save"

**Expected result:**
- ✅ "Save" button is **disabled**
- ✅ Contact field shows red border
- ✅ Error message: "Contact cannot exceed 255 characters"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B6: Create Companion - Success (all fields correct)

**Pre-requisite:** "Companions" tab open

**Steps:**
1. Click "Add companion"
2. Fill in fields:
   - FirstName: "John"
   - LastName: "Doe"
   - Contact: "john.doe@example.com"

3. Click "Save"

**Expected result:**
- ✅ "Save" button shows spinner
- ✅ After ~1-2 seconds, **MudSnackbar** (Success) appears:
  - "Companion added: John Doe"
- ✅ Form is **hidden**
- ✅ Companions list **refreshed** (new companion visible)
- ✅ Tab label updates: "Companions (1)"
- ✅ EmptyState **is not displayed** (list has items)

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B7: Create Companion - Success without contact (optional field)

**Steps:**
1. Click "Add companion"
2. Fill in fields:
   - FirstName: "Jane"
   - LastName: "Smith"
   - Contact: **empty**

3. Click "Save"

**Expected result:**
- ✅ Form is accepted (Contact optional)
- ✅ After ~1-2 seconds, **MudSnackbar** (Success) appears:
  - "Companion added: Jane Smith"
- ✅ Companions list **refreshed**
- ✅ Companion displayed **without contact** (name only)

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B8: Create Companion - Cancel

**Steps:**
1. Click "Add companion"
2. Fill in some fields
3. Click "Cancel"

**Expected result:**
- ✅ Form is **hidden**
- ✅ Form data is **lost**
- ✅ No confirmation dialog
- ✅ Companions list **does not change**

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B9: Read Companions - List with companions

**Pre-requisite:** At least 2 companions added (Test Case B6, B7)

**Steps:**
1. Check the "Companions" tab

**Expected result:**
- ✅ Display of **CompanionList**
- ✅ Each companion as **MudListItem** with:
  - First and Last name (Typo.body1)
  - Contact (Typo.body2, Secondary) - if present
  - Trash icon (delete)
- ✅ Companions sorted alphabetically by FirstName (ascending)

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B10: Delete Companion - Confirmation dialog

**Pre-requisite:** At least 1 companion added

**Steps:**
1. In the "Companions" tab, click the trash icon next to a companion
2. Check the confirmation dialog

**Expected result:**
- ✅ Display of **DeleteCompanionConfirmationDialog**
- ✅ Title: "Confirm deletion"
- ✅ Content: "Are you sure you want to delete **[First name] [Last name]** from the trip?"
- ✅ Buttons:
  - "Cancel" (default, on the left)
  - "Delete" (red, on the right)
- ✅ **No warning alert** (less critical operation than deleting a trip)

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B11: Delete Companion - Cancel deletion

**Pre-requisite:** Confirmation dialog open (Test Case B10)

**Steps:**
1. Click "Cancel" in the dialog (or press Escape)

**Expected result:**
- ✅ Dialog closes
- ✅ No further actions
- ✅ Companion is **not deleted**
- ✅ Companions list **does not change**

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B12: Delete Companion - Confirm deletion (SUCCESS)

**Pre-requisite:** Confirmation dialog open (Test Case B10)

**Steps:**
1. Click "Delete" in the dialog

**Expected result:**
- ✅ Dialog closes
- ✅ After ~1-2 seconds, **MudSnackbar** (Success) appears:
  - "Companion has been deleted."
- ✅ Companions list **refreshed** (companion disappeared)
- ✅ Tab label updates: "Companions (X)" (counter decreased)
- ✅ If it was the last companion → **EmptyState** displayed

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B13: Companion Ownership - Verify trip owner

**Pre-requisite:** User A has a trip with companions, User B logged in

**Steps:**
1. Log in as User B
2. Try to add a companion to User A's trip (direct API call or URL manipulation)

**Expected result:**
- ✅ Backend returns **NotFoundException** (trip not found - RLS blocks)
- ✅ UI displays **MudSnackbar** (Warning):
  - "Trip not found."
- ✅ Redirect to `/trips`

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

## SECTION C: PROFILES

### Test Case C1: Read Profile - Display logged-in user profile

**Pre-requisite:** User logged in

**Steps:**
1. Click on the user avatar in NavMenu (top right corner)
2. Select "Profile" from dropdown menu
3. Check the `/profile` page

**Expected result:**
- ✅ Profile page displayed with data:
  - Email (read-only, from Supabase Auth)
  - DisplayName (editable)
  - AvatarUrl (editable)
  - CreatedAt (read-only)
  - UpdatedAt (read-only)
- ✅ Fields filled with data from database (if profile exists)
- ✅ Avatar displayed from AvatarUrl (if present)

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case C2: Update Profile - Edit DisplayName

**Pre-requisite:** `/profile` page open

**Steps:**
1. Change DisplayName field to "New Display Name"
2. Click "Save changes"

**Expected result:**
- ✅ "Save changes" button shows spinner
- ✅ After ~1-2 seconds, **MudSnackbar** (Success) appears:
  - "Profile has been updated!"
- ✅ Form remains open (no redirect)
- ✅ DisplayName field updated with new value
- ✅ NavMenu (LoginDisplay) shows new name

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case C3: Update Profile - DisplayName too long (> 100 characters)

**Steps:**
1. In DisplayName field, enter text longer than 100 characters
2. Click "Save changes"

**Expected result:**
- ✅ "Save changes" button is **disabled**
- ✅ DisplayName field shows red border
- ✅ Error message: "Display name cannot exceed 100 characters"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case C4: Update Profile - DisplayName empty (ValidationException)

**Steps:**
1. Clear DisplayName field (leave empty)
2. Click "Save changes"

**Expected result:**
- ✅ "Save changes" button is **disabled** (client-side validation)
- ✅ DisplayName field shows red border
- ✅ Error message: "Display name cannot be empty"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case C5: Update Profile - Edit AvatarUrl (valid URL)

**Steps:**
1. In AvatarUrl field, enter: `https://example.com/avatar.jpg`
2. Click "Save changes"

**Expected result:**
- ✅ "Save changes" button shows spinner
- ✅ After ~1-2 seconds, **MudSnackbar** (Success) appears:
  - "Profile has been updated!"
- ✅ Avatar displayed from new URL
- ✅ NavMenu (LoginDisplay) shows new avatar

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case C6: Update Profile - AvatarUrl invalid format (ValidationException)

**Steps:**
1. In AvatarUrl field, enter: `invalid-url` (without http/https)
2. Click "Save changes"

**Expected result:**
- ✅ "Save changes" button is **disabled**
- ✅ AvatarUrl field shows red border
- ✅ Error message: "Invalid URL format"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case C7: Update Profile - AvatarUrl too long (> 500 characters)

**Steps:**
1. In AvatarUrl field, enter a URL longer than 500 characters
2. Click "Save changes"

**Expected result:**
- ✅ "Save changes" button is **disabled**
- ✅ AvatarUrl field shows red border
- ✅ Error message: "Avatar URL cannot exceed 500 characters"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case C8: Update Profile - Partial Update (DisplayName only)

**Steps:**
1. Change only DisplayName field to "Updated Name"
2. Leave AvatarUrl **unchanged**
3. Click "Save changes"

**Expected result:**
- ✅ Backend updates **only** DisplayName field
- ✅ AvatarUrl field **does not change** (partial update)
- ✅ **MudSnackbar** (Success): "Profile has been updated!"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case C9: Update Profile - Partial Update (AvatarUrl only)

**Steps:**
1. Change only AvatarUrl field to new URL
2. Leave DisplayName **unchanged**
3. Click "Save changes"

**Expected result:**
- ✅ Backend updates **only** AvatarUrl field
- ✅ DisplayName field **does not change**
- ✅ **MudSnackbar** (Success): "Profile has been updated!"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case C10: Update Profile - No changes (ValidationException)

**Steps:**
1. Open `/profile`
2. **Do not change any fields**
3. Click "Save changes"

**Expected result:**
- ✅ Backend returns **ValidationException**: "At least one field must be provided for update"
- ✅ **MudAlert** (Warning) with error message
- ✅ Form remains open

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

## SECTION D: ADVANCED SCENARIOS

### Test Case D1: Parallel loading (Trip + Companions)

**Pre-requisite:** Trip with companions created

**Steps:**
1. Open DevTools (F12) → Network tab
2. Open `/trip/{id}`
3. Check network calls

**Expected result:**
- ✅ Two parallel requests:
  - GET `/rest/v1/trips?id=eq.{id}`
  - GET `/rest/v1/companions?trip_id=eq.{id}`
- ✅ Both requests executed **simultaneously** (Task.WhenAll)
- ✅ Load time < 1 second (if network OK)
- ✅ Global spinner visible during loading

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case D2: Breadcrumbs - navigation

**Pre-requisite:** `/trip/{id}` page open

**Steps:**
1. Check breadcrumbs: "My trips > [Trip name]"
2. Click "My trips"

**Expected result:**
- ✅ Redirect to `/trips`
- ✅ Breadcrumb dynamically updates trip name (if changed)

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case D3: Tabs - tab switching

**Pre-requisite:** `/trip/{id}` page open

**Steps:**
1. Click "Companions (X)" tab
2. Check the content
3. Click "Details" tab

**Expected result:**
- ✅ Smooth tab switching (no flickering)
- ✅ Data is **not reloaded** (already in memory)
- ✅ Active tab highlighted
- ✅ Companion counter dynamically updated

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case D4: EmptyState - no trips

**Pre-requisite:** New user without trips

**Steps:**
1. Log in as a new user
2. Navigate to `/trips`

**Expected result:**
- ✅ Display of **EmptyState**:
  - Title: "No trips"
  - Message: "Start planning your first adventure!"
  - Icon: Icons.Material.Filled.Luggage
  - ButtonText: "Add first trip"
- ✅ Clicking the button → redirect to `/trip/create`

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case D5: LoadingSpinner - global loading state

**Pre-requisite:** Slow internet connection (throttling in DevTools)

**Steps:**
1. DevTools → Network → Throttling: Slow 3G
2. Open `/trip/{id}`

**Expected result:**
- ✅ Immediate display of **LoadingSpinner** with message:
  - "Loading trip..."
- ✅ Spinner visible during Task.WhenAll (Trip + Companions)
- ✅ After loading: spinner disappears, content displayed

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case D6: Responsiveness - Mobile view

**Steps:**
1. DevTools (F12) → Toggle Device Toolbar (Ctrl+Shift+M)
2. Select iPhone 12 Pro
3. Test all views:
   - `/trips` (trips list)
   - `/trip/create` (create trip)
   - `/trip/{id}` (details + companions)
   - `/profile` (profile)

**Expected result:**
- ✅ All components responsive (no overflow)
- ✅ Trip cards stacked vertically
- ✅ Forms readable (fields not too small)
- ✅ Buttons clickable (min. 44x44px touch target)
- ✅ Dialogs full width (MaxWidth.Small)
- ✅ Tabs scrollable (if too many)

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case D7: Keyboard Navigation - Tab + Enter

**Steps:**
1. Navigate to `/trip/create`
2. Use **keyboard only** to fill the form:
   - Tab - switch between fields
   - Enter - submit form

**Expected result:**
- ✅ All fields accessible via Tab
- ✅ Focus visible (blue border)
- ✅ Enter submits form (if validation OK)
- ✅ Buttons accessible via Tab
- ✅ Dialogs closed by Escape

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case D8: Browser Console - no errors

**Steps:**
1. DevTools (F12) → Console
2. Go through complete CRUD flow:
- Create trip
   - Edit trip
   - Add companion
   - Delete companion
   - Delete trip

**Expected result:**
- ✅ No JS errors (red messages)
- ⚠️ Warnings (yellow) may appear - that's OK
- ✅ Console logs:
  ```
  Retrieved 3 trips for user {userId}
  Retrieved trip {tripId} with 2 companions
  Created trip {tripId} for user {userId}
  Updated trip {tripId}
  Added companion {companionId} to trip {tripId}
  Removed companion {companionId}
  Deleted trip {tripId}
  ```

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case D9: Network Tab - API Calls

**Steps:**
1. DevTools (F12) → Network
2. Perform CRUD operations
3. Check requests to Supabase

**Expected result:**
- ✅ **Create Trip**: POST `/rest/v1/trips`
- ✅ **Read Trips**: GET `/rest/v1/trips?user_id=eq.{userId}`
- ✅ **Read Trip**: GET `/rest/v1/trips?id=eq.{id}`
- ✅ **Update Trip**: PATCH `/rest/v1/trips?id=eq.{id}`
- ✅ **Delete Trip**: DELETE `/rest/v1/trips?id=eq.{id}`
- ✅ **Add Companion**: POST `/rest/v1/companions`
- ✅ **Delete Companion**: DELETE `/rest/v1/companions?id=eq.{id}`
- ✅ All requests: Status **200 OK** (or 201 Created)
- ✅ Headers contain: `Authorization: Bearer {JWT_TOKEN}`

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case D10: CASCADE Delete - Delete trip with companions

**Pre-requisite:** Trip with 2+ companions

**Steps:**
1. Open `/trip/{id}` (trip has companions)
2. Delete the trip (Test Case A13)
3. Check database (Supabase Dashboard → Table Editor)

**Expected result:**
- ✅ Trip deleted from `trips` table
- ✅ All companions **automatically deleted** from `companions` table (CASCADE)
- ✅ No "orphaned" companions (companions without trip)

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

## Bugs Found

| # | Description | Severity | Status | Test Case |
|---|-------------|----------|--------|-----------|
| - | None found yet | - | - | - |

---

## Notes

- 
- 
- 

---

## Test Coverage Summary

### Trips CRUD
- ☐ A1-A6: Create Trip (validation + success)
- ☐ A7-A8: Read Trip (list + details)
- ☐ A9-A10: Update Trip (edit + validation)
- ☐ A11-A13: Delete Trip (dialog + confirmation)
- ☐ A14: RLS Security

### Companions CRUD
- ☐ B1: EmptyState
- ☐ B2-B8: Create Companion (validation + success)
- ☐ B9: Read Companions (list)
- ☐ B10-B12: Delete Companion (dialog + confirmation)
- ☐ B13: Ownership Verification

### Profiles
- ☐ C1: Read Profile
- ☐ C2-C10: Update Profile (partial updates + validation)

### Advanced Scenarios
- ☐ D1: Parallel loading
- ☐ D2: Breadcrumbs
- ☐ D3: Tabs
- ☐ D4: EmptyState
- ☐ D5: LoadingSpinner
- ☐ D6: Responsiveness
- ☐ D7: Keyboard Navigation
- ☐ D8: Browser Console
- ☐ D9: Network Tab
- ☐ D10: CASCADE Delete

---

**Test Execution Date:** 2025-01-XX  
**Tester:** User  
**Overall Status:** ⏳ Not Started

**Estimated Testing Time:** 4-6 hours (all test cases)

---

## Testing Strategy

### Phase 1: Create Operations (1 hour)
- Test Case A1-A6 (Create Trip)
- Test Case B1-B8 (Create Companion)

### Phase 2: Read Operations (30 min)
- Test Case A7-A8 (Read Trip)
- Test Case B9 (Read Companions)
- Test Case C1 (Read Profile)

### Phase 3: Update Operations (1 hour)
- Test Case A9-A10 (Update Trip)
- Test Case C2-C10 (Update Profile)

### Phase 4: Delete Operations (1 hour)
- Test Case A11-A13 (Delete Trip)
- Test Case B10-B12 (Delete Companion)
- Test Case D10 (CASCADE Delete)

### Phase 5: Security & Advanced (1-2 hours)
- Test Case A14 (RLS Security)
- Test Case B13 (Ownership Verification)
- Test Case D1-D9 (Advanced Scenarios)

### Phase 6: Accessibility & UX (30 min)
- Test Case D6 (Responsiveness)
- Test Case D7 (Keyboard Navigation)
- Test Case D8-D9 (Console + Network)

---

## Exit Criteria

✅ All test cases executed  
✅ Critical bugs fixed
✅ RLS security verified  
✅ No console errors  
✅ Responsive on mobile + desktop  
✅ Keyboard navigation works  
✅ All CRUD operations functional

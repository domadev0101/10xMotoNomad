# Test Plan - CRUD Operations

**Data:** 2025-01-XX  
**Feature:** CRUD Operations (Trips, Companions, Profiles)  
**Status:** ⏳ Not Started

---

## Pre-requisites

- [x] User logged in with valid session
- [x] `appsettings.json` configured with real Supabase URL and Anon Key
- [x] `MockAuth.Enabled: false`
- [x] Database tables created (trips, companions, profiles)
- [x] RLS policies enabled and tested
- [x] All services registered in Program.cs

---

## SECTION A: TRIPS CRUD

### Test Case A1: Create Trip - Formularz walidacja - puste pola

**Kroki:**
1. Zaloguj się do aplikacji
2. Przejdź do `/trip/create`
3. Kliknij przycisk "Zapisz" **bez wpisywania danych**

**Oczekiwany rezultat:**
- ✅ Przycisk "Zapisz" jest **disabled** (bo `_formValid = false`)
- ✅ Pola pokazują czerwone bordery:
  - Name: "Nazwa wycieczki jest wymagana"
  - StartDate: "Data rozpoczęcia jest wymagana"
  - EndDate: "Data zakończenia jest wymagana"
  - TransportType: "Rodzaj transportu jest wymagany"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case A2: Create Trip - Walidacja dat (EndDate <= StartDate)

**Kroki:**
1. Przejdź do `/trip/create`
2. Wypełnij pola:
 - Name: "Test Trip"
   - StartDate: 2025-02-15
   - EndDate: 2025-02-10 (wcześniej niż StartDate)
   - Transport: Motorcycle

3. Kliknij "Zapisz"

**Oczekiwany rezultat:**
- ✅ Przycisk "Zapisz" jest **disabled**
- ✅ Pole EndDate pokazuje czerwony border
- ✅ Komunikat błędu: "Data zakończenia musi być późniejsza niż data rozpoczęcia"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case A3: Create Trip - Nazwa za długa (> 200 znaków)

**Kroki:**
1. Przejdź do `/trip/create`
2. W polu Name wpisz tekst dłuższy niż 200 znaków
3. Wypełnij pozostałe pola poprawnie
4. Kliknij "Zapisz"

**Oczekiwany rezultat:**
- ✅ Przycisk "Zapisz" jest **disabled**
- ✅ Pole Name pokazuje czerwony border
- ✅ Komunikat błędu: "Nazwa nie może przekraczać 200 znaków"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case A4: Create Trip - Opis za długi (> 2000 znaków)

**Kroki:**
1. Przejdź do `/trip/create`
2. Wypełnij wszystkie wymagane pola poprawnie
3. W polu Description wpisz tekst dłuższy niż 2000 znaków
4. Kliknij "Zapisz"

**Oczekiwany rezultat:**
- ✅ Przycisk "Zapisz" jest **disabled**
- ✅ Pole Description pokazuje czerwony border
- ✅ Komunikat błędu: "Opis nie może przekraczać 2000 znaków"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case A5: Create Trip - Sukces (wszystkie pola poprawne)

**Kroki:**
1. Przejdź do `/trip/create`
2. Wypełnij pola:
   - Name: "Test Motorcycle Trip"
   - StartDate: 2025-03-01
   - EndDate: 2025-03-10
   - Description: "Test description for trip"
   - Transport: Motorcycle

3. Kliknij "Zapisz"

**Oczekiwany rezultat:**
- ✅ Przycisk "Zapisz" pokazuje spinner + "Zapisywanie..."
- ✅ Po ~1-2 sekundach pojawia się **MudSnackbar** (Success):
  - "Wycieczka 'Test Motorcycle Trip' została utworzona!"
- ✅ Użytkownik jest **automatycznie przekierowany** na `/trips`
- ✅ Nowa wycieczka pojawia się na liście z:
  - Nazwą: "Test Motorcycle Trip"
  - Datami: 01.03.2025 - 10.03.2025
  - Duration: 9 dni
  - Transport: Motorcycle icon
  - Companion count: 0

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case A6: Create Trip - Anulowanie

**Kroki:**
1. Przejdź do `/trip/create`
2. Wypełnij część pól
3. Kliknij "Anuluj"

**Oczekiwany rezultat:**
- ✅ Użytkownik jest **natychmiast przekierowany** na `/trips`
- ✅ Dane formularza są **tracone** (brak auto-save)
- ✅ Brak dialogu potwierdzenia

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case A7: Read Trip - Lista wycieczek (GetAllTrips)

**Pre-requisite:** Co najmniej 1 wycieczka utworzona (Test Case A5)

**Kroki:**
1. Przejdź do `/trips`
2. Sprawdź listę wycieczek

**Oczekiwany rezultat:**
- ✅ Lista wyświetla wszystkie wycieczki użytkownika
- ✅ Każda karta zawiera:
  - Nazwę wycieczki
  - Daty (StartDate - EndDate)
  - Duration (obliczone dni)
  - Transport icon (odpowiednia ikona dla typu)
  - Companion count (liczba towarzyszy)
- ✅ Wycieczki posortowane po StartDate (malejąco - najnowsze na górze)
- ✅ Kliknięcie karty → przekierowanie na `/trip/{id}`

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case A8: Read Trip - Szczegóły wycieczki (GetTripById)

**Pre-requisite:** Co najmniej 1 wycieczka utworzona

**Kroki:**
1. Przejdź do `/trips`
2. Kliknij na kartę wycieczki
3. Sprawdź zawartość strony `/trip/{id}`

**Oczekiwany rezultat:**
- ✅ Równoległe ładowanie Trip + Companions (spinner globalny)
- ✅ Po załadowaniu widoczne:
  - Breadcrumbs: "Moje wycieczki > [Nazwa wycieczki]"
  - Zakładka "Szczegóły" (aktywna domyślnie)
  - Zakładka "Towarzysze (0)"
- ✅ Formularz edycji wypełniony danymi:
  - Name
  - StartDate
  - EndDate
  - Description
  - TransportType
- ✅ Przyciski:
  - "Zapisz zmiany" (Primary, aktywny)
  - Ikona kosza "Usuń wycieczkę" (Error)

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case A9: Update Trip - Edycja nazwy

**Pre-requisite:** Wycieczka utworzona i otwarty `/trip/{id}`

**Kroki:**
1. W zakładce "Szczegóły" zmień pole Name na "Updated Trip Name"
2. Kliknij "Zapisz zmiany"

**Oczekiwany rezultat:**
- ✅ Przycisk "Zapisz zmiany" pokazuje spinner
- ✅ Po ~1-2 sekundach pojawia się **MudSnackbar** (Success):
  - "Zmiany zostały zapisane!"
- ✅ Formularz pozostaje otwarty (brak przekierowania)
- ✅ Breadcrumb aktualizuje nazwę: "Moje wycieczki > Updated Trip Name"
- ✅ Przejście do `/trips` → karta wyświetla nową nazwę

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case A10: Update Trip - Walidacja dat (EndDate <= StartDate)

**Pre-requisite:** Wycieczka utworzona i otwarty `/trip/{id}`

**Kroki:**
1. Zmień EndDate na datę wcześniejszą niż StartDate
2. Kliknij "Zapisz zmiany"

**Oczekiwany rezultat:**
- ✅ Przycisk "Zapisz zmiany" jest **disabled**
- ✅ Pole EndDate pokazuje czerwony border
- ✅ Komunikat błędu: "Data zakończenia musi być późniejsza niż data rozpoczęcia"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case A11: Delete Trip - Potwierdzenie dialogu

**Pre-requisite:** Wycieczka utworzona i otwarty `/trip/{id}`

**Kroki:**
1. W zakładce "Szczegóły" kliknij ikonę kosza "Usuń wycieczkę"
2. Sprawdź dialog potwierdzenia

**Oczekiwany rezultat:**
- ✅ Wyświetlenie **DeleteTripConfirmationDialog**
- ✅ Tytuł: "Potwierdzenie usunięcia"
- ✅ Treść: "Czy na pewno chcesz usunąć wycieczkę **[Nazwa wycieczki]**?"
- ✅ Alert ostrzegawczy (żółty): "Ta operacja jest nieodwracalna. Wszystkie dane związane z wycieczką, w tym lista towarzyszy, zostaną trwale usunięte."
- ✅ Przyciski:
  - "Anuluj" (domyślny, po lewej)
  - "Usuń" (czerwony, po prawej)

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case A12: Delete Trip - Anulowanie usunięcia

**Pre-requisite:** Dialog potwierdzenia otwarty (Test Case A11)

**Kroki:**
1. Kliknij "Anuluj" w dialogu (lub naciśnij Escape)

**Oczekiwany rezultat:**
- ✅ Dialog zostaje zamknięty
- ✅ Brak dalszych akcji
- ✅ Wycieczka **nie zostaje usunięta**
- ✅ Pozostanie na stronie `/trip/{id}`

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case A13: Delete Trip - Potwierdzenie usunięcia (SUCCESS)

**Pre-requisite:** Dialog potwierdzenia otwarty (Test Case A11)

**Kroki:**
1. Kliknij "Usuń" w dialogu

**Oczekiwany rezultat:**
- ✅ Dialog zostaje zamknięty
- ✅ Po ~1-2 sekundach pojawia się **MudSnackbar** (Success):
  - "Wycieczka '[Nazwa wycieczki]' została usunięta."
- ✅ Użytkownik jest **automatycznie przekierowany** na `/trips`
- ✅ Wycieczka **nie pojawia się** na liście (została usunięta z bazy)

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case A14: RLS Security - Próba dostępu do cudzej wycieczki

**Pre-requisite:** Dwie konta użytkowników (User A, User B), User A ma wycieczki

**Kroki:**
1. Zaloguj się jako User A
2. Otwórz wycieczkę → skopiuj ID z URL (`/trip/{id}`)
3. Wyloguj się
4. Zaloguj się jako User B
5. Wklej URL z ID wycieczki User A

**Oczekiwany rezultat:**
- ✅ Po próbie załadowania wycieczki pojawia się **MudSnackbar** (Warning):
  - "Nie znaleziono wycieczki."
- ✅ Użytkownik jest **automatycznie przekierowany** na `/trips`
- ✅ Brak możliwości odczytu cudzych wycieczek (RLS blokuje)

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

## SECTION B: COMPANIONS CRUD

### Test Case B1: Read Companions - Lista pusta (EmptyState)

**Pre-requisite:** Wycieczka utworzona bez towarzyszy

**Kroki:**
1. Otwórz `/trip/{id}`
2. Przełącz się na zakładkę "Towarzysze (0)"

**Oczekiwany rezultat:**
- ✅ Wyświetlenie **EmptyState**:
  - Title: "Brak towarzyszy"
  - Message: "Dodaj osoby, które będą Cię towarzyszyć w podróży"
  - Icon: Icons.Material.Filled.People
  - ButtonText: "Dodaj pierwszego towarzysza"
- ✅ Kliknięcie przycisku → wyświetlenie CompanionForm

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B2: Create Companion - Walidacja - puste pola

**Pre-requisite:** Zakładka "Towarzysze" otwarta, formularz widoczny

**Kroki:**
1. Kliknij "Dodaj towarzysza" (jeśli formularz ukryty)
2. Kliknij "Zapisz" **bez wpisywania danych**

**Oczekiwany rezultat:**
- ✅ Przycisk "Zapisz" jest **disabled** (bo `_formValid = false`)
- ✅ Pola pokazują czerwone bordery:
  - FirstName: "Imię jest wymagane"
  - LastName: "Nazwisko jest wymagane"
- ✅ Pole Contact **nie pokazuje błędu** (opcjonalne)

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B3: Create Companion - Imię za długie (> 100 znaków)

**Kroki:**
1. W formularzu towarzysza wpisz:
   - FirstName: tekst dłuższy niż 100 znaków
   - LastName: "Test"

2. Kliknij "Zapisz"

**Oczekiwany rezultat:**
- ✅ Przycisk "Zapisz" jest **disabled**
- ✅ Pole FirstName pokazuje czerwony border
- ✅ Komunikat błędu: "Imię nie może przekraczać 100 znaków"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B4: Create Companion - Nazwisko za długie (> 100 znaków)

**Kroki:**
1. W formularzu towarzysza wpisz:
   - FirstName: "Test"
   - LastName: tekst dłuższy niż 100 znaków

2. Kliknij "Zapisz"

**Oczekiwany rezultat:**
- ✅ Przycisk "Zapisz" jest **disabled**
- ✅ Pole LastName pokazuje czerwony border
- ✅ Komunikat błędu: "Nazwisko nie może przekraczać 100 znaków"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B5: Create Companion - Kontakt za długi (> 255 znaków)

**Kroki:**
1. W formularzu towarzysza wpisz:
   - FirstName: "Test"
   - LastName: "User"
   - Contact: tekst dłuższy niż 255 znaków

2. Kliknij "Zapisz"

**Oczekiwany rezultat:**
- ✅ Przycisk "Zapisz" jest **disabled**
- ✅ Pole Contact pokazuje czerwony border
- ✅ Komunikat błędu: "Kontakt nie może przekraczać 255 znaków"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B6: Create Companion - Sukces (wszystkie pola poprawne)

**Pre-requisite:** Zakładka "Towarzysze" otwarta

**Kroki:**
1. Kliknij "Dodaj towarzysza"
2. Wypełnij pola:
   - FirstName: "John"
   - LastName: "Doe"
   - Contact: "john.doe@example.com"

3. Kliknij "Zapisz"

**Oczekiwany rezultat:**
- ✅ Przycisk "Zapisz" pokazuje spinner
- ✅ Po ~1-2 sekundach pojawia się **MudSnackbar** (Success):
  - "Dodano towarzysza: John Doe"
- ✅ Formularz zostaje **ukryty**
- ✅ Lista towarzyszy **odświeżona** (nowy towarzysz widoczny)
- ✅ Etykieta zakładki aktualizuje się: "Towarzysze (1)"
- ✅ EmptyState **nie jest wyświetlany** (lista ma elementy)

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B7: Create Companion - Sukces bez kontaktu (pole opcjonalne)

**Kroki:**
1. Kliknij "Dodaj towarzysza"
2. Wypełnij pola:
   - FirstName: "Jane"
   - LastName: "Smith"
   - Contact: **puste**

3. Kliknij "Zapisz"

**Oczekiwany rezultat:**
- ✅ Formularz zostaje zaakceptowany (Contact opcjonalne)
- ✅ Po ~1-2 sekundach pojawia się **MudSnackbar** (Success):
  - "Dodano towarzysza: Jane Smith"
- ✅ Lista towarzyszy **odświeżona**
- ✅ Towarzysz wyświetlany **bez kontaktu** (tylko imię i nazwisko)

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B8: Create Companion - Anulowanie

**Kroki:**
1. Kliknij "Dodaj towarzysza"
2. Wypełnij część pól
3. Kliknij "Anuluj"

**Oczekiwany rezultat:**
- ✅ Formularz zostaje **ukryty**
- ✅ Dane formularza są **tracone**
- ✅ Brak dialogu potwierdzenia
- ✅ Lista towarzyszy **nie zmienia się**

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B9: Read Companions - Lista z towarzyszami

**Pre-requisite:** Co najmniej 2 towarzyszy dodanych (Test Case B6, B7)

**Kroki:**
1. Sprawdź zakładkę "Towarzysze"

**Oczekiwany rezultat:**
- ✅ Wyświetlenie **CompanionList**
- ✅ Każdy towarzysz jako **MudListItem** z:
  - Imię i Nazwisko (Typo.body1)
  - Kontakt (Typo.body2, Secondary) - jeśli jest
  - Ikona kosza (usuwanie)
- ✅ Towarzysze posortowani alfabetycznie po FirstName (ascending)

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B10: Delete Companion - Potwierdzenie dialogu

**Pre-requisite:** Co najmniej 1 towarzysz dodany

**Kroki:**
1. W zakładce "Towarzysze" kliknij ikonę kosza przy towarzyszu
2. Sprawdź dialog potwierdzenia

**Oczekiwany rezultat:**
- ✅ Wyświetlenie **DeleteCompanionConfirmationDialog**
- ✅ Tytuł: "Potwierdzenie usunięcia"
- ✅ Treść: "Czy na pewno chcesz usunąć **[Imię] [Nazwisko]** z wycieczki?"
- ✅ Przyciski:
  - "Anuluj" (domyślny, po lewej)
  - "Usuń" (czerwony, po prawej)
- ✅ **Brak alertu ostrzegawczego** (mniej krytyczna operacja niż usuwanie wycieczki)

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B11: Delete Companion - Anulowanie usunięcia

**Pre-requisite:** Dialog potwierdzenia otwarty (Test Case B10)

**Kroki:**
1. Kliknij "Anuluj" w dialogu (lub naciśnij Escape)

**Oczekiwany rezultat:**
- ✅ Dialog zostaje zamknięty
- ✅ Brak dalszych akcji
- ✅ Towarzysz **nie zostaje usunięty**
- ✅ Lista towarzyszy **nie zmienia się**

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B12: Delete Companion - Potwierdzenie usunięcia (SUCCESS)

**Pre-requisite:** Dialog potwierdzenia otwarty (Test Case B10)

**Kroki:**
1. Kliknij "Usuń" w dialogu

**Oczekiwany rezultat:**
- ✅ Dialog zostaje zamknięty
- ✅ Po ~1-2 sekundach pojawia się **MudSnackbar** (Success):
  - "Towarzysz został usunięty."
- ✅ Lista towarzyszy **odświeżona** (towarzysz zniknął)
- ✅ Etykieta zakładki aktualizuje się: "Towarzysze (X)" (licznik zmniejszony)
- ✅ Jeśli był ostatni towarzysz → wyświetlenie **EmptyState**

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case B13: Companion Ownership - Weryfikacja właściciela wycieczki

**Pre-requisite:** User A ma wycieczkę z towarzyszami, User B zalogowany

**Kroki:**
1. Zaloguj się jako User B
2. Spróbuj dodać towarzysza do wycieczki User A (API call bezpośredni lub manipulacja URL)

**Oczekiwany rezultat:**
- ✅ Backend zwraca **NotFoundException** (trip not found - RLS blokuje)
- ✅ UI wyświetla **MudSnackbar** (Warning):
  - "Nie znaleziono wycieczki."
- ✅ Przekierowanie na `/trips`

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

## SECTION C: PROFILES

### Test Case C1: Read Profile - Wyświetlenie profilu zalogowanego użytkownika

**Pre-requisite:** User zalogowany

**Kroki:**
1. Kliknij na awatar użytkownika w NavMenu (prawym górnym rogu)
2. Wybierz "Profil" z dropdown menu
3. Sprawdź stronę `/profile`

**Oczekiwany rezultat:**
- ✅ Wyświetlenie strony profilu z danymi:
  - Email (read-only, z Supabase Auth)
- DisplayName (edytowalne)
  - AvatarUrl (edytowalne)
  - CreatedAt (read-only)
  - UpdatedAt (read-only)
- ✅ Pola wypełnione danymi z bazy (jeśli profil już istnieje)
- ✅ Avatar wyświetlany z AvatarUrl (jeśli jest)

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case C2: Update Profile - Edycja DisplayName

**Pre-requisite:** Strona `/profile` otwarta

**Kroki:**
1. Zmień pole DisplayName na "New Display Name"
2. Kliknij "Zapisz zmiany"

**Oczekiwany rezultat:**
- ✅ Przycisk "Zapisz zmiany" pokazuje spinner
- ✅ Po ~1-2 sekundach pojawia się **MudSnackbar** (Success):
  - "Profil został zaktualizowany!"
- ✅ Formularz pozostaje otwarty (brak przekierowania)
- ✅ Pole DisplayName aktualizowane nową wartością
- ✅ NavMenu (LoginDisplay) pokazuje nową nazwę

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case C3: Update Profile - DisplayName za długie (> 100 znaków)

**Kroki:**
1. W polu DisplayName wpisz tekst dłuższy niż 100 znaków
2. Kliknij "Zapisz zmiany"

**Oczekiwany rezultat:**
- ✅ Przycisk "Zapisz zmiany" jest **disabled**
- ✅ Pole DisplayName pokazuje czerwony border
- ✅ Komunikat błędu: "Nazwa wyświetlana nie może przekraczać 100 znaków"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case C4: Update Profile - DisplayName puste (ValidationException)

**Kroki:**
1. Wyczyść pole DisplayName (zostaw puste)
2. Kliknij "Zapisz zmiany"

**Oczekiwany rezultat:**
- ✅ Przycisk "Zapisz zmiany" jest **disabled** (walidacja klienta)
- ✅ Pole DisplayName pokazuje czerwony border
- ✅ Komunikat błędu: "Nazwa wyświetlana nie może być pusta"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case C5: Update Profile - Edycja AvatarUrl (valid URL)

**Kroki:**
1. W polu AvatarUrl wpisz: `https://example.com/avatar.jpg`
2. Kliknij "Zapisz zmiany"

**Oczekiwany rezultat:**
- ✅ Przycisk "Zapisz zmiany" pokazuje spinner
- ✅ Po ~1-2 sekundach pojawia się **MudSnackbar** (Success):
  - "Profil został zaktualizowany!"
- ✅ Avatar wyświetlany z nowego URL
- ✅ NavMenu (LoginDisplay) pokazuje nowy avatar

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case C6: Update Profile - AvatarUrl niepoprawny format (ValidationException)

**Kroki:**
1. W polu AvatarUrl wpisz: `invalid-url` (bez http/https)
2. Kliknij "Zapisz zmiany"

**Oczekiwany rezultat:**
- ✅ Przycisk "Zapisz zmiany" jest **disabled**
- ✅ Pole AvatarUrl pokazuje czerwony border
- ✅ Komunikat błędu: "Nieprawidłowy format URL"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case C7: Update Profile - AvatarUrl za długie (> 500 znaków)

**Kroki:**
1. W polu AvatarUrl wpisz URL dłuższy niż 500 znaków
2. Kliknij "Zapisz zmiany"

**Oczekiwany rezultat:**
- ✅ Przycisk "Zapisz zmiany" jest **disabled**
- ✅ Pole AvatarUrl pokazuje czerwony border
- ✅ Komunikat błędu: "URL avatara nie może przekraczać 500 znaków"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case C8: Update Profile - Partial Update (tylko DisplayName)

**Kroki:**
1. Zmień tylko pole DisplayName na "Updated Name"
2. Pole AvatarUrl **pozostaw bez zmian**
3. Kliknij "Zapisz zmiany"

**Oczekiwany rezultat:**
- ✅ Backend aktualizuje **tylko** pole DisplayName
- ✅ Pole AvatarUrl **nie zmienia się** (partial update)
- ✅ **MudSnackbar** (Success): "Profil został zaktualizowany!"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case C9: Update Profile - Partial Update (tylko AvatarUrl)

**Kroki:**
1. Zmień tylko pole AvatarUrl na nowy URL
2. Pole DisplayName **pozostaw bez zmian**
3. Kliknij "Zapisz zmiany"

**Oczekiwany rezultat:**
- ✅ Backend aktualizuje **tylko** pole AvatarUrl
- ✅ Pole DisplayName **nie zmienia się**
- ✅ **MudSnackbar** (Success): "Profil został zaktualizowany!"

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case C10: Update Profile - Brak zmian (ValidationException)

**Kroki:**
1. Otwórz `/profile`
2. **Nie zmieniaj żadnych pól**
3. Kliknij "Zapisz zmiany"

**Oczekiwany rezultat:**
- ✅ Backend zwraca **ValidationException**: "At least one field must be provided for update"
- ✅ **MudAlert** (Warning) z komunikatem błędu
- ✅ Formularz pozostaje otwarty

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

## SECTION D: ADVANCED SCENARIOS

### Test Case D1: Równoległe ładowanie (Trip + Companions)

**Pre-requisite:** Wycieczka z towarzyszami utworzona

**Kroki:**
1. Otwórz DevTools (F12) → Network tab
2. Otwórz `/trip/{id}`
3. Sprawdź network calls

**Oczekiwany rezultat:**
- ✅ Dwa równoległe requesty:
  - GET `/rest/v1/trips?id=eq.{id}`
  - GET `/rest/v1/companions?trip_id=eq.{id}`
- ✅ Oba requesty wykonywane **jednocześnie** (Task.WhenAll)
- ✅ Czas ładowania < 1 sekundy (jeśli sieć OK)
- ✅ Globalny spinner widoczny podczas ładowania

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case D2: Breadcrumbs - nawigacja

**Pre-requisite:** Otwarta strona `/trip/{id}`

**Kroki:**
1. Sprawdź breadcrumbs: "Moje wycieczki > [Nazwa wycieczki]"
2. Kliknij "Moje wycieczki"

**Oczekiwany rezultat:**
- ✅ Przekierowanie na `/trips`
- ✅ Breadcrumb dynamicznie aktualizuje nazwę wycieczki (jeśli została zmieniona)

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case D3: Tabs - przełączanie zakładek

**Pre-requisite:** Otwarta strona `/trip/{id}`

**Kroki:**
1. Kliknij zakładkę "Towarzysze (X)"
2. Sprawdź zawartość
3. Kliknij zakładkę "Szczegóły"

**Oczekiwany rezultat:**
- ✅ Płynne przełączanie zakładek (brak migotania)
- ✅ Dane **nie są ładowane ponownie** (już w pamięci)
- ✅ Aktywna zakładka podświetlona
- ✅ Licznik towarzyszy dynamicznie aktualizowany

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case D4: EmptyState - brak wycieczek

**Pre-requisite:** Nowy użytkownik bez wycieczek

**Kroki:**
1. Zaloguj się jako nowy użytkownik
2. Przejdź do `/trips`

**Oczekiwany rezultat:**
- ✅ Wyświetlenie **EmptyState**:
  - Title: "Brak wycieczek"
  - Message: "Zacznij planować swoją pierwszą przygodę!"
  - Icon: Icons.Material.Filled.Luggage
  - ButtonText: "Dodaj pierwszą wycieczkę"
- ✅ Kliknięcie przycisku → przekierowanie na `/trip/create`

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case D5: LoadingSpinner - globalny stan ładowania

**Pre-requisite:** Wolne połączenie internetowe (throttling w DevTools)

**Kroki:**
1. DevTools → Network → Throttling: Slow 3G
2. Otwórz `/trip/{id}`

**Oczekiwany rezultat:**
- ✅ Natychmiastowe wyświetlenie **LoadingSpinner** z komunikatem:
  - "Ładowanie wycieczki..."
- ✅ Spinner widoczny podczas Task.WhenAll (Trip + Companions)
- ✅ Po załadowaniu: spinner znika, wyświetlenie zawartości

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case D6: Responsywność - Mobile view

**Kroki:**
1. DevTools (F12) → Toggle Device Toolbar (Ctrl+Shift+M)
2. Wybierz iPhone 12 Pro
3. Testuj wszystkie widoki:
   - `/trips` (lista wycieczek)
   - `/trip/create` (tworzenie)
   - `/trip/{id}` (szczegóły + towarzysze)
   - `/profile` (profil)

**Oczekiwany rezultat:**
- ✅ Wszystkie komponenty responsywne (brak overflow)
- ✅ Karty wycieczek stackowane pionowo
- ✅ Formularze czytelne (pola nie za małe)
- ✅ Przyciski klikalne (min. 44x44px touch target)
- ✅ Dialogi pełna szerokość (MaxWidth.Small)
- ✅ Zakładki przewijalne (jeśli za dużo)

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case D7: Keyboard Navigation - Tab + Enter

**Kroki:**
1. Przejdź do `/trip/create`
2. Użyj **tylko klawiatury** do wypełnienia formularza:
   - Tab - przełączanie między polami
   - Enter - submit formularza

**Oczekiwany rezultat:**
- ✅ Wszystkie pola dostępne przez Tab
- ✅ Focus widoczny (niebieski border)
- ✅ Enter wysyła formularz (jeśli walidacja OK)
- ✅ Przyciski dostępne przez Tab
- ✅ Dialogi zamykane przez Escape

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case D8: Browser Console - brak błędów

**Kroki:**
1. DevTools (F12) → Console
2. Przejdź przez cały flow CRUD:
   - Tworzenie wycieczki
   - Edycja wycieczki
   - Dodawanie towarzysza
   - Usuwanie towarzysza
   - Usuwanie wycieczki

**Oczekiwany rezultat:**
- ✅ Brak błędów JS (czerwone komunikaty)
- ⚠️ Mogą być warningi (żółte) - to OK
- ✅ Console logi:
  ```
  Retrieved 3 trips for user {userId}
  Retrieved trip {tripId} with 2 companions
  Created trip {tripId} for user {userId}
  Updated trip {tripId}
  Added companion {companionId} to trip {tripId}
  Removed companion {companionId}
  Deleted trip {tripId}
  ```

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case D9: Network Tab - API Calls

**Kroki:**
1. DevTools (F12) → Network
2. Wykonaj operacje CRUD
3. Sprawdź requesty do Supabase

**Oczekiwany rezultat:**
- ✅ **Create Trip**: POST `/rest/v1/trips`
- ✅ **Read Trips**: GET `/rest/v1/trips?user_id=eq.{userId}`
- ✅ **Read Trip**: GET `/rest/v1/trips?id=eq.{id}`
- ✅ **Update Trip**: PATCH `/rest/v1/trips?id=eq.{id}`
- ✅ **Delete Trip**: DELETE `/rest/v1/trips?id=eq.{id}`
- ✅ **Add Companion**: POST `/rest/v1/companions`
- ✅ **Delete Companion**: DELETE `/rest/v1/companions?id=eq.{id}`
- ✅ Wszystkie requesty: Status **200 OK** (lub 201 Created)
- ✅ Headers zawierają: `Authorization: Bearer {JWT_TOKEN}`

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

### Test Case D10: CASCADE Delete - Usuwanie wycieczki z towarzyszami

**Pre-requisite:** Wycieczka z 2+ towarzyszami

**Kroki:**
1. Otwórz `/trip/{id}` (wycieczka ma towarzyszy)
2. Usuń wycieczkę (Test Case A13)
3. Sprawdź bazę danych (Supabase Dashboard → Table Editor)

**Oczekiwany rezultat:**
- ✅ Wycieczka usunięta z tabeli `trips`
- ✅ Wszyscy towarzysze **automatycznie usunięci** z tabeli `companions` (CASCADE)
- ✅ Brak "orphaned" companions (towarzyszy bez wycieczki)

**Status:** ☐ Not Tested / ✅ Passed / ❌ Failed

---

## Bugs Found

| # | Description | Severity | Status | Test Case |
|---|-------------|----------|--------|-----------|
| - | None found yet | - | - | - |

---

## Notes

- 
- 
- 

---

## Test Coverage Summary

### Trips CRUD
- ☐ A1-A6: Create Trip (walidacja + sukces)
- ☐ A7-A8: Read Trip (lista + szczegóły)
- ☐ A9-A10: Update Trip (edycja + walidacja)
- ☐ A11-A13: Delete Trip (dialog + potwierdzenie)
- ☐ A14: RLS Security

### Companions CRUD
- ☐ B1: EmptyState
- ☐ B2-B8: Create Companion (walidacja + sukces)
- ☐ B9: Read Companions (lista)
- ☐ B10-B12: Delete Companion (dialog + potwierdzenie)
- ☐ B13: Ownership Verification

### Profiles
- ☐ C1: Read Profile
- ☐ C2-C10: Update Profile (partial updates + walidacja)

### Advanced Scenarios
- ☐ D1: Równoległe ładowanie
- ☐ D2: Breadcrumbs
- ☐ D3: Tabs
- ☐ D4: EmptyState
- ☐ D5: LoadingSpinner
- ☐ D6: Responsywność
- ☐ D7: Keyboard Navigation
- ☐ D8: Browser Console
- ☐ D9: Network Tab
- ☐ D10: CASCADE Delete

---

**Test Execution Date:** 2025-01-XX  
**Tester:** User  
**Overall Status:** ⏳ Not Started

**Estimated Testing Time:** 4-6 hours (all test cases)

---

## Testing Strategy

### Phase 1: Create Operations (1 hour)
- Test Case A1-A6 (Create Trip)
- Test Case B1-B8 (Create Companion)

### Phase 2: Read Operations (30 min)
- Test Case A7-A8 (Read Trip)
- Test Case B9 (Read Companions)
- Test Case C1 (Read Profile)

### Phase 3: Update Operations (1 hour)
- Test Case A9-A10 (Update Trip)
- Test Case C2-C10 (Update Profile)

### Phase 4: Delete Operations (1 hour)
- Test Case A11-A13 (Delete Trip)
- Test Case B10-B12 (Delete Companion)
- Test Case D10 (CASCADE Delete)

### Phase 5: Security & Advanced (1-2 hours)
- Test Case A14 (RLS Security)
- Test Case B13 (Ownership Verification)
- Test Case D1-D9 (Advanced Scenarios)

### Phase 6: Accessibility & UX (30 min)
- Test Case D6 (Responsywność)
- Test Case D7 (Keyboard Navigation)
- Test Case D8-D9 (Console + Network)

---

## Exit Criteria

✅ All test cases executed  
✅ Critical bugs fixed
✅ RLS security verified  
✅ No console errors  
✅ Responsive on mobile + desktop  
✅ Keyboard navigation works  
✅ All CRUD operations functional

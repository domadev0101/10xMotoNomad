<MudDialog>
    <DialogContent>
        <MudForm @ref="_form" @bind-IsValid="_formValid" ValidationDelay="0">
            <MudStack Spacing="3">
                <MudTextField Value="_displayName"
      ValueChanged="@((string? value) => OnDisplayNameChanged(value))"
       Label="Display Name"
              Required="true"
              Variant="Variant.Outlined"
          Validation="@ValidateDisplayName" Counter="100"
            HelperText="Your display name (max 100 characters)" />

    <MudTextField Value="_avatarUrl"
        ValueChanged="@((string? value) => OnAvatarUrlChanged(value))"
     Label="Avatar URL"
      Variant="Variant.Outlined"
      Validation="@ValidateAvatarUrl" Counter="500"
       HelperText="URL to your profile picture (optional)" />

   @if (!string.IsNullOrWhiteSpace(_avatarUrl))
             {
       <MudStack Row="true" AlignItems="AlignItems.Center" Spacing="2">
 <MudText Typo="Typo.body2" Color="Color.Secondary">Preview:</MudText>
     <MudAvatar Size="Size.Medium">
  <MudImage Src="@_avatarUrl" Alt="Avatar Preview" />
             </MudAvatar>
       </MudStack>
                }

                @if (_validationErrors.Count > 0)
    {
           <MudAlert Severity="Severity.Warning">
            @foreach (var error in _validationErrors)
     {
            <MudText Typo="Typo.caption">• @error.Key: @error.Value.FirstOrDefault()</MudText>
               }
  </MudAlert>
     }
    </MudStack>
  </MudForm>
    </DialogContent>
<DialogActions>
        <MudButton OnClick="Cancel" Variant="Variant.Text">
     Cancel
</MudButton>
        <MudButton OnClick="SaveChanges" 
   Color="Color.Primary" 
          Variant="Variant.Filled"
           Disabled="@(!_formValid || _isSaving)">
@if (_isSaving)
            {
    <MudProgressCircular Size="Size.Small" Indeterminate="true" />
    <MudText Class="ml-2">Saving...</MudText>
            }
       else
            {
    <text>Save Changes</text>
  }
        </MudButton>
    </DialogActions>
</MudDialog>
